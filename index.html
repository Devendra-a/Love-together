<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SyncWatch - Watch Together</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Room Setup Modal -->
    <div id="roomModal" class="modal">
        <div class="modal-content">
            <h2>Join SyncWatch</h2>
            <div class="form-group">
                <label for="usernameInput" class="form-label">Your Nickname:</label>
                <input type="text" id="usernameInput" class="form-control" placeholder="Enter your nickname" maxlength="20">
            </div>
            <div class="form-group">
                <label for="roomCodeInput" class="form-label">Room Code (leave empty to create new):</label>
                <input type="text" id="roomCodeInput" class="form-control" placeholder="Enter room code or leave empty">
            </div>
            <button id="joinRoomBtn" class="btn btn--primary btn--full-width">Join Room</button>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="app" class="app hidden">
        <!-- Top Bar -->
        <header class="top-bar">
            <div class="top-bar__left">
                <h1 class="app-title">SyncWatch</h1>
                <div class="room-info">
                    <span class="room-code">Room: <span id="currentRoomCode"></span></span>
                    <button id="copyRoomBtn" class="btn btn--sm btn--outline">Copy Link</button>
                </div>
            </div>
            <div class="top-bar__right">
                <div class="connection-status">
                    <span id="connectionStatus" class="status status--info">Connecting...</span>
                </div>
                <div class="user-list">
                    <span class="user-count">Users: <span id="userCount">1</span></span>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Video Section -->
            <section class="video-section">
                <!-- Video URL Input -->
                <div class="video-url-section">
                    <input type="url" id="videoUrlInput" class="form-control video-url-input" placeholder="Paste video URL (MP4, WebM, or streaming URL)">
                    <button id="loadVideoBtn" class="btn btn--primary">Load Video</button>
                </div>

                <!-- Video Player Container -->
                <div class="video-container">
                    <video id="mainVideo" class="main-video" controls crossorigin="anonymous">
                        <source src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                    
                    <!-- Video Chat Overlay -->
                    <div id="videoChatOverlay" class="video-chat-overlay hidden">
                        <div class="video-chat-container">
                            <div id="localVideo" class="video-chat-window">
                                <video class="peer-video" muted autoplay></video>
                                <span class="video-username">You</span>
                            </div>
                        </div>
                    </div>

                    <!-- Sync Status Indicator -->
                    <div id="syncIndicator" class="sync-indicator hidden">
                        <span>üîÑ Syncing...</span>
                    </div>
                </div>

                <!-- Video Controls -->
                <div class="video-controls">
                    <button id="playPauseBtn" class="btn btn--outline">
                        <span id="playPauseIcon">‚ñ∂Ô∏è</span>
                    </button>
                    <div class="progress-container">
                        <input type="range" id="progressBar" class="progress-bar" min="0" max="100" value="0">
                        <span id="timeDisplay" class="time-display">0:00 / 0:00</span>
                    </div>
                    <div class="volume-container">
                        <button id="muteBtn" class="btn btn--outline">üîä</button>
                        <input type="range" id="volumeBar" class="volume-bar" min="0" max="100" value="50">
                    </div>
                    <button id="fullscreenBtn" class="btn btn--outline">‚õ∂</button>
                </div>
            </section>

            <!-- Chat Sidebar -->
            <aside class="chat-sidebar">
                <!-- Chat Controls -->
                <div class="chat-controls">
                    <button id="toggleVideoChatBtn" class="btn btn--outline">üìπ Video Chat</button>
                    <button id="toggleAudioBtn" class="btn btn--outline">
                        <span id="audioIcon">üé§</span> Audio
                    </button>
                    <button id="screenShareBtn" class="btn btn--outline">üñ•Ô∏è Share Screen</button>
                </div>

                <!-- Connected Users -->
                <div class="connected-users">
                    <h3>Connected Users</h3>
                    <div id="usersList" class="users-list"></div>
                </div>

                <!-- Chat Messages -->
                <div class="chat-container">
                    <div id="chatMessages" class="chat-messages">
                        <div class="system-message">Welcome to SyncWatch! Start chatting...</div>
                    </div>
                    
                    <!-- Typing Indicator -->
                    <div id="typingIndicator" class="typing-indicator hidden">
                        <span>Someone is typing...</span>
                    </div>
                    
                    <!-- Chat Input -->
                    <div class="chat-input-container">
                        <input type="text" id="chatInput" class="form-control chat-input" placeholder="Type a message..." maxlength="500">
                        <button id="sendMessageBtn" class="btn btn--primary">Send</button>
                        <button id="voiceMessageBtn" class="btn btn--outline voice-btn">üé§</button>
                    </div>
                </div>
            </aside>
        </main>
    </div>

    <!-- Audio Elements for Voice Messages -->
    <audio id="audioPlayer" preload="none"></audio>
    
    <!-- Notification Container -->
    <div id="notifications" class="notifications"></div>

    <script src="app.js"></script>
</body>
</html>